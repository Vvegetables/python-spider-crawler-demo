#coding=utf-8
import urllib2

#下载网页的函数

def download(url,user_agent='wswp',num_retries=2):
    print 'download:',url
    headers = {'User-agent':user_agent}
    
    try:
        request = urllib2.Request(url,headers=headers)
#         html = urllib2.urlopen(url).read()
        html = urllib2.urlopen(request).read()
    except urllib2.URLError as e:
        #有疑问
        print 'Download error:',e
        
        html = None
        if num_retries > 0:
            if hasattr(e,'code') and 500 <= e.code < 600:
                return download(url,num_retries-1)
        
        return html

if __name__ == '__main__':
    url = 'http://www.meetup.com/'
    user_agent = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'
    html = download(url,user_agent)
    print html